<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小男孩冒险成长游戏</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --primary-light: #5dade2;
            --primary-dark: #2980b9;
            --secondary-color: #2ecc71;
            --secondary-light: #58d68d;
            --secondary-dark: #27ae60;
            --accent-color: #e74c3c;
            --accent-light: #ec7063;
            --dark-bg: #1a5276;
            --container-bg: #2874a6;
            --stat-bg: #3498db;
            --text-color: #ecf0f1;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --info-color: #3498db;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(52, 152, 219, 0.3) 0%, transparent 20%),
                radial-gradient(circle at 85% 30%, rgba(46, 204, 113, 0.2) 0%, transparent 20%),
                radial-gradient(circle at 50% 80%, rgba(243, 156, 18, 0.2) 0%, transparent 20%);
        }
        
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--container-bg);
            padding: 25px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            border: 3px solid var(--primary-light);
            background-image: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%);
        }
        
        .game-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
            border-radius: 20px 20px 0 0;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            text-align: center;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            padding-bottom: 10px;
            flex-grow: 1;
        }
        
        h1::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 25%;
            width: 50%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
            border-radius: 3px;
        }
        
        .player-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            box-shadow: var(--shadow);
            border: 3px solid white;
            cursor: pointer;
            transition: transform 0.3s;
            overflow: hidden;
        }
        
        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .player-avatar:hover {
            transform: scale(1.05);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        
        .character-card {
            background-color: var(--stat-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--secondary-color);
            position: relative;
            overflow: hidden;
        }
        
        .character-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
        }
        
        .character-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .character-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            margin-right: 15px;
            box-shadow: var(--shadow);
            border: 2px solid white;
            cursor: pointer;
            transition: transform 0.3s;
            overflow: hidden;
        }
        
        .character-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .character-avatar:hover {
            transform: scale(1.05);
        }
        
        .character-info h2 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        
        .character-info h2 i {
            margin-left: 10px;
            font-size: 1rem;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .character-info h2 i:hover {
            opacity: 1;
        }
        
        .character-info p {
            opacity: 0.8;
            font-size: 0.9rem;
        }
        
        .character-stats {
            margin-top: 15px;
        }
        
        .character-stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .character-stat:last-child {
            border-bottom: none;
        }
        
        .stat-name {
            display: flex;
            align-items: center;
        }
        
        .stat-name i {
            margin-right: 8px;
            width: 20px;
            text-align: center;
        }
        
        .stat-value {
            font-weight: bold;
        }
        
        .character-illustration {
            margin-top: 20px;
            text-align: center;
        }
        
        .illustration-container {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            box-shadow: var(--shadow);
        }
        
        .illustration-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .game-content {
            display: flex;
            flex-direction: column;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat {
            background-color: var(--stat-bg);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s;
            border-left: 4px solid var(--secondary-color);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .stat::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
        }
        
        .stat:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        
        .stat i {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 1.3rem;
            color: #fff;
        }
        
        .progress-container {
            background-color: var(--stat-bg);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--secondary-color);
        }
        
        .progress-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            border-radius: 12px 12px 0 0;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .progress-bar {
            height: 25px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 12px;
            width: 0%;
            transition: width 0.8s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .actions-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .action-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: #fff;
            border: none;
            padding: 15px 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            position: relative;
            overflow: hidden;
            font-size: 1rem;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 80px;
        }
        
        .action-btn i {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }
        
        .action-btn::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .action-btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        
        .action-btn:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        
        .action-btn:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
        }
        
        .secondary-actions {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }
        
        .secondary-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .secondary-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .skills-items-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .skills-container, .items-container {
            background-color: var(--stat-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--secondary-color);
            position: relative;
        }
        
        .skills-container::before, .items-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
            border-radius: 12px 12px 0 0;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .skills-list, .items-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .skill-badge, .item-badge {
            background: linear-gradient(135deg, var(--secondary-color), var(--secondary-dark));
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .skill-badge i, .item-badge i {
            margin-right: 5px;
            font-size: 0.8rem;
        }
        
        .log-container {
            background-color: var(--dark-bg);
            padding: 20px;
            border-radius: 12px;
            height: 250px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .log-entry {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            animation: fadeIn 0.3s ease;
            padding-left: 10px;
            border-left: 3px solid var(--primary-color);
        }
        
        .log-time {
            color: #bdc3c7;
            font-size: 0.8em;
            margin-bottom: 5px;
        }
        
        .log-message {
            margin-top: 3px;
            line-height: 1.5;
        }
        
        .danger {
            color: var(--danger-color);
        }
        
        .success {
            color: var(--success-color);
        }
        
        .warning {
            color: var(--warning-color);
        }
        
        .info {
            color: var(--info-color);
        }
        
        .highlight {
            color: #fff;
            font-weight: bold;
        }
        
        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--warning-color), #e67e22);
            color: #fff;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 8px;
            animation: pulse 2s infinite;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--success-color), var(--secondary-dark));
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 2000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            max-width: 300px;
            border-left: 4px solid white;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--container-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .modal-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.7);
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: white;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background-color: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 1rem;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .avatar-options {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 10px;
        }
        
        .avatar-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            overflow: hidden;
        }
        
        .avatar-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .avatar-option:hover {
            transform: scale(1.1);
        }
        
        .avatar-option.selected {
            border-color: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
        }
        
        .upload-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .upload-btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .upload-btn:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
        }
        
        .upload-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 15px auto;
            border: 2px solid white;
            overflow: hidden;
            display: none;
        }
        
        .upload-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .version-info {
            text-align: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .region-selector {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            justify-content: center;
        }
        
        .region-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .region-btn.active {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }
        
        .region-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .region-btn.active:hover {
            background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
        }
        
        .energy-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9rem;
        }
        
        .energy-info h3 {
            margin-bottom: 10px;
            color: var(--primary-light);
        }
        
        .energy-info ul {
            padding-left: 20px;
        }
        
        .energy-info li {
            margin-bottom: 5px;
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .skills-items-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .actions-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .game-header {
                flex-direction: column;
                text-align: center;
            }
            
            .player-avatar {
                margin-top: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .avatar-options {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .region-selector {
                flex-wrap: wrap;
            }
        }
        
        @media (max-width: 480px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .actions-container {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .avatar-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .log-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .log-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }
        
        .log-container::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }
        
        .log-container::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>小男孩冒险成长游戏</h1>
            <div class="player-avatar" onclick="openEditModal()">
                <i class="fas fa-child"></i>
            </div>
        </div>
        
        <div class="main-content">
            <!-- 角色卡片区域 -->
            <div class="character-card">
                <div class="character-header">
                    <div class="character-avatar" onclick="openEditModal()">
                        <i class="fas fa-child"></i>
                    </div>
                    <div class="character-info">
                        <h2 id="characterName">小明 <i class="fas fa-edit" onclick="openEditModal()"></i></h2>
                        <p id="characterAge">年龄: 6岁</p>
                    </div>
                </div>
                
                <div class="character-stats">
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-heart"></i>
                            <span>体力</span>
                        </div>
                        <div class="stat-value" id="characterHealth">100/100</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-bolt"></i>
                            <span>精力</span>
                        </div>
                        <div class="stat-value" id="characterEnergy">50/100</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-smile"></i>
                            <span>快乐值</span>
                        </div>
                        <div class="stat-value" id="characterHappiness">50</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-brain"></i>
                            <span>智力</span>
                        </div>
                        <div class="stat-value" id="characterIntelligence">30</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-fist-raised"></i>
                            <span>力量</span>
                        </div>
                        <div class="stat-value" id="characterStrength">25</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-users"></i>
                            <span>社交</span>
                        </div>
                        <div class="stat-value" id="characterSocial">20</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-ruler-vertical"></i>
                            <span>身高</span>
                        </div>
                        <div class="stat-value" id="characterHeight">115cm</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-weight"></i>
                            <span>体重</span>
                        </div>
                        <div class="stat-value" id="characterWeight">20kg</div>
                    </div>
                    <div class="character-stat">
                        <div class="stat-name">
                            <i class="fas fa-coins"></i>
                            <span>零花钱</span>
                        </div>
                        <div class="stat-value" id="characterMoney">50</div>
                    </div>
                </div>
                
                <!-- 角色立绘 -->
                <div class="character-illustration">
                    <div class="illustration-container" id="characterIllustration">
                        <!-- 立绘将通过JavaScript动态加载 -->
                        <div id="defaultIllustration" style="display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;">
                            <i class="fas fa-child" style="font-size: 4rem; margin-bottom: 10px;"></i>
                            <p>上传立绘图片</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 游戏内容区域 -->
            <div class="game-content">
                <!-- 统计信息区域 -->
                <div class="stats-container">
                    <div class="stat">
                        <i class="fas fa-user-graduate"></i>
                        <div class="stat-label">成长阶段</div>
                        <div class="stat-value" id="realm">幼儿园</div>
                    </div>
                    <div class="stat">
                        <i class="fas fa-paint-brush"></i>
                        <div class="stat-label">兴趣班</div>
                        <div class="stat-value" id="school">未选择</div>
                    </div>
                    <div class="stat">
                        <i class="fas fa-users"></i>
                        <div class="stat-label">朋友圈</div>
                        <div class="stat-value" id="faction">独自玩耍</div>
                    </div>
                    <div class="stat">
                        <i class="fas fa-map-marker-alt"></i>
                        <div class="stat-label">活动区域</div>
                        <div class="stat-value" id="region">家里</div>
                    </div>
                </div>
                
                <!-- 地点选择器 -->
                <div class="region-selector">
                    <button class="region-btn active" data-region="家里" onclick="changeRegion('家里')">
                        <i class="fas fa-home"></i> 家里
                    </button>
                    <button class="region-btn" data-region="学校" onclick="changeRegion('学校')">
                        <i class="fas fa-school"></i> 学校
                    </button>
                    <button class="region-btn" data-region="公园" onclick="changeRegion('公园')">
                        <i class="fas fa-tree"></i> 公园
                    </button>
                </div>
                
                <!-- 成长进度条 -->
                <div class="progress-container">
                    <div class="progress-label">
                        <span><i class="fas fa-chart-line"></i> 成长进度</span>
                        <span id="cultivationPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cultivationProgress"></div>
                    </div>
                </div>
                
                <!-- 体力精力消耗说明 -->
                <div class="energy-info">
                    <h3><i class="fas fa-info-circle"></i> 体力和精力消耗说明</h3>
                    <ul>
                        <li><strong>探索</strong>：可能消耗体力，可能获得技能或物品</li>
                        <li><strong>学习</strong>：消耗精力，成功则增加智力和精力，失败则消耗体力</li>
                        <li><strong>锻炼</strong>：消耗精力，增加成长经验和力量</li>
                        <li><strong>游戏</strong>：消耗体力，胜利增加社交和精力，失败减少快乐值</li>
                    </ul>
                </div>

                <!-- 主要操作按钮区域 -->
                <div class="actions-container">
                    <button class="action-btn" onclick="explore()">
                        <i class="fas fa-binoculars"></i>
                        <span>探索</span>
                    </button>
                    <button class="action-btn" onclick="refineBug()">
                        <i class="fas fa-book"></i>
                        <span>学习</span>
                    </button>
                    <button class="action-btn" onclick="cultivate()">
                        <i class="fas fa-running"></i>
                        <span>锻炼</span>
                    </button>
                    <button class="action-btn" onclick="fight()">
                        <i class="fas fa-gamepad"></i>
                        <span>游戏</span>
                    </button>
                    <button class="action-btn" onclick="useItem()">
                        <i class="fas fa-gift"></i>
                        <span>使用物品</span>
                    </button>
                    <button class="action-btn" onclick="breakthrough()">
                        <i class="fas fa-level-up-alt"></i>
                        <span>成长</span>
                    </button>
                </div>
                
                <!-- 次要操作按钮 -->
                <div class="secondary-actions">
                    <button class="secondary-btn" onclick="openSettingsModal()">
                        <i class="fas fa-cog"></i> 更多设置
                    </button>
                </div>
                
                <!-- 技能和物品展示区域 -->
                <div class="skills-items-container">
                    <div class="skills-container">
                        <div class="section-header">
                            <span><i class="fas fa-tools"></i> 已学技能</span>
                            <span id="skillsCount">0</span>
                        </div>
                        <div class="skills-list" id="skillsList">
                            <!-- 技能将通过JavaScript动态添加 -->
                        </div>
                    </div>
                    
                    <div class="items-container">
                        <div class="section-header">
                            <span><i class="fas fa-box-open"></i> 拥有物品</span>
                            <span id="itemsCount">0</span>
                        </div>
                        <div class="items-list" id="itemsList">
                            <!-- 物品将通过JavaScript动态添加 -->
                        </div>
                    </div>
                </div>
                
                <!-- 游戏日志区域 -->
                <div class="log-container" id="log"></div>
                
                <!-- 版本信息 -->
                <div class="version-info" id="versionInfo">
                    版本号: 1.2.0 | 最后更新: 2023-10-15
                </div>
            </div>
        </div>
    </div>

    <!-- 通知组件 -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText"></span>
    </div>

    <!-- 角色编辑模态框 -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeEditModal()">&times;</span>
            <div class="modal-header">
                <h2 class="modal-title">编辑角色信息</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="newName">角色姓名</label>
                    <input type="text" class="form-input" id="newName" placeholder="请输入角色姓名">
                </div>
                
                <div class="form-group">
                    <label class="form-label">选择头像</label>
                    <div class="avatar-options">
                        <div class="avatar-option selected" data-icon="fas fa-child">
                            <i class="fas fa-child"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user-alt">
                            <i class="fas fa-user-alt"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user-astronaut">
                            <i class="fas fa-user-astronaut"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user-ninja">
                            <i class="fas fa-user-ninja"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user-graduate">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user-tie">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div class="avatar-option" data-icon="fas fa-user-injured">
                            <i class="fas fa-user-injured"></i>
                        </div>
                    </div>
                    
                    <div class="upload-section">
                        <label class="form-label">上传自定义头像</label>
                        <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
                        <div class="upload-btn" onclick="document.getElementById('avatarUpload').click()">
                            <i class="fas fa-upload"></i> 选择图片
                        </div>
                        <div class="upload-preview" id="uploadPreview">
                            <img id="previewImage" src="" alt="预览">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">上传角色立绘</label>
                    <input type="file" id="illustrationUpload" accept="image/*" style="display: none;">
                    <div class="upload-btn" onclick="document.getElementById('illustrationUpload').click()">
                        <i class="fas fa-image"></i> 选择立绘图片
                    </div>
                    <div class="upload-preview" id="illustrationPreview" style="width: 150px; height: 150px; border-radius: 10px;">
                        <img id="previewIllustration" src="" alt="立绘预览">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="newHeight">身高 (cm)</label>
                    <input type="number" class="form-input" id="newHeight" placeholder="请输入身高" min="50" max="200">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="newWeight">体重 (kg)</label>
                    <input type="number" class="form-input" id="newWeight" placeholder="请输入体重" min="10" max="100">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeEditModal()">取消</button>
                <button class="btn btn-primary" onclick="saveCharacterInfo()">保存</button>
            </div>
        </div>
    </div>

    <!-- 设置模态框 -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeSettingsModal()">&times;</span>
            <div class="modal-header">
                <h2 class="modal-title">游戏设置</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">更换兴趣班</label>
                    <div class="region-selector">
                        <button class="region-btn" data-school="无" onclick="changeSchool('无')">
                            无
                        </button>
                        <button class="region-btn" data-school="美术班" onclick="changeSchool('美术班')">
                            美术班
                        </button>
                        <button class="region-btn" data-school="音乐班" onclick="changeSchool('音乐班')">
                            音乐班
                        </button>
                        <button class="region-btn" data-school="体育班" onclick="changeSchool('体育班')">
                            体育班
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">更换朋友圈</label>
                    <div class="region-selector">
                        <button class="region-btn" data-faction="独自玩耍" onclick="changeFaction('独自玩耍')">
                            独自玩耍
                        </button>
                        <button class="region-btn" data-faction="学霸圈" onclick="changeFaction('学霸圈')">
                            学霸圈
                        </button>
                        <button class="region-btn" data-faction="游戏圈" onclick="changeFaction('游戏圈')">
                            游戏圈
                        </button>
                        <button class="region-btn" data-faction="户外圈" onclick="changeFaction('户外圈')">
                            户外圈
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">游戏说明</label>
                    <div class="energy-info">
                        <p>这是一个小男孩成长游戏，你可以通过探索、学习、锻炼和游戏来提升自己的能力。</p>
                        <p>随着成长阶段的提升，你的角色会逐渐长大，获得新的能力和体验。</p>
                        <p>注意保持体力和精力，合理规划你的活动！</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeSettingsModal()">确定</button>
            </div>
        </div>
    </div>

    <script>
        // =============================================================================
        // 游戏数据定义 - 小男孩成长主题
        // =============================================================================
        let gameData = {
            // 角色基本信息
            characterName: "小明",
            characterAge: 6,
            characterAvatar: "fas fa-child", // 默认头像
            characterAvatarType: "icon", // 头像类型: "icon" 或 "image"
            characterAvatarData: null, // 如果是图片头像，存储Base64数据
            characterHeight: 115, // 身高 (cm)
            characterWeight: 20,  // 体重 (kg)
            
            // 角色立绘
            characterIllustration: null, // 立绘图片数据
            characterIllustrationType: "default", // 立绘类型: "default" 或 "image"
            
            // 游戏版本信息
            gameVersion: "1.2.0",
            lastUpdate: "2023-10-15",
            
            // 基本属性
            realm: 1,                    // 当前成长阶段
            health: 100,                 // 当前体力值
            maxHealth: 100,              // 最大体力值
            essence: 50,                 // 当前精力值
            maxEssence: 100,             // 最大精力值
            bugs: [],                    // 学到的技能列表
            items: [],                   // 拥有的物品列表
            primaryBug: null,            // 主要特长
            cultivationExp: 0,           // 当前成长经验
            cultivationTarget: 100,      // 成长所需经验
            lifeSpan: 50,                // 快乐值
            
            // 角色属性
            intelligence: 30,            // 智力
            strength: 25,                // 力量
            social: 20,                  // 社交能力
            money: 50,                   // 零花钱
            
            // 游戏设定
            school: "无",                 // 当前兴趣班
            faction: "独自玩耍",          // 当前朋友圈
            region: "家里",               // 当前活动区域
            
            // 成长阶段名称映射表
            realmNames: [
                "幼儿园", "小学低年级", "小学高年级", "初中", "高中",
                "大学", "研究生", "职场新人",
                "成熟人士"
            ],
            
            // 技能库定义
            bugLibrary: [
                { name: "画画", effect: "提升创造力，快乐值+10", rarity: "common", icon: "fas fa-palette" },
                { name: "音乐", effect: "提升艺术感，精力恢复+20%", rarity: "rare", icon: "fas fa-music" },
                { name: "编程", effect: "解锁特殊能力（需特定条件）", rarity: "legendary", icon: "fas fa-code" },
                { name: "运动", effect: "提升体力上限和恢复速度", rarity: "uncommon", icon: "fas fa-running" },
                { name: "阅读", effect: "增加知识，学习效果提升", rarity: "common", icon: "fas fa-book" },
                { name: "手工", effect: "提升动手能力和专注力", rarity: "uncommon", icon: "fas fa-tools" },
                { name: "科学实验", effect: "探索世界，发现新事物", rarity: "rare", icon: "fas fa-flask" },
                { name: "外语", effect: "打开新世界的大门", rarity: "epic", icon: "fas fa-language" }
            ],
            
            // 物品库定义
            itemLibrary: [
                { name: "零食", effect: "恢复30点体力", type: "consumable", icon: "fas fa-cookie" },
                { name: "饮料", effect: "恢复50点体力", type: "consumable", icon: "fas fa-wine-bottle" },
                { name: "玩具", effect: "增加5点快乐值", type: "consumable", icon: "fas fa-gamepad" },
                { name: "书籍", effect: "增加10点智力", type: "permanent", icon: "fas fa-book-open" },
                { name: "运动鞋", effect: "增加5点力量", type: "permanent", icon: "fas fa-shoe-prints" },
                { name: "手机", effect: "增加10点社交", type: "permanent", icon: "fas fa-mobile-alt" }
            ],
            
            // 兴趣班定义
            schools: [
                {
                    name: "美术班", 
                    description: "擅长绘画和创作，学习创造力技能成功率+20%，但体力消耗+10%",
                    bugBonus: ["画画", "手工"]
                },
                {
                    name: "音乐班", 
                    description: "培养音乐天赋，游戏时可使用音乐技能，但精力上限-20%",
                    bugBonus: ["音乐", "表演"]
                },
                {
                    name: "体育班", 
                    description: "增强体质，体力+30%，但精力消耗+20%",
                    bugBonus: ["运动", "户外活动"]
                }
            ],
            
            // 朋友圈定义
            factions: [
                {
                    name: "学霸圈", 
                    description: "学习氛围浓厚，每月可领取10精力，但需完成学习任务",
                    perks: ["每月资源", "学习技巧"],
                    quests: ["完成作业", "参加竞赛"]
                },
                {
                    name: "游戏圈", 
                    description: "游戏时快乐值恢复+15%，可分享游戏经验，但学习效果-10%",
                    perks: ["游戏技巧", "快乐分享"],
                    quests: ["通关游戏", "组队游戏"]
                },
                {
                    name: "户外圈", 
                    description: "自由探索大自然，体力恢复快，可发现稀有物品",
                    perks: ["自然探索", "体能增强"]
                }
            ],
            
            // 活动区域定义
            regions: [
                {
                    name: "家里", 
                    description: "安全舒适，每月随机获得1个技能，但探索机会较少",
                    bugs: ["阅读", "手工"]
                },
                {
                    name: "学校", 
                    description: "学习氛围浓厚，学习效果额外+20%，但精力恢复-15%",
                    bugs: ["学习", "社交"]
                },
                {
                    name: "公园", 
                    description: "户外活动丰富，体力恢复+30%，但可能遇到挑战",
                    bugs: ["运动", "自然观察"]
                }
            ],
            
            // 成就列表
            achievements: []
        };

        // =============================================================================
        // 工具函数
        // =============================================================================
        
        /**
         * 显示通知消息
         * @param {string} message - 要显示的消息内容
         * @param {string} type - 消息类型，可选值: "success", "warning", "danger"
         */
        function showNotification(message, type = "success") {
            const notification = document.getElementById("notification");
            const notificationText = document.getElementById("notificationText");
            
            notificationText.textContent = message;
            notification.className = "notification";
            
            // 根据类型设置颜色
            if (type === "success") {
                notification.style.background = "linear-gradient(135deg, var(--success-color), var(--secondary-dark))";
            } else if (type === "warning") {
                notification.style.background = "linear-gradient(135deg, var(--warning-color), #e67e22)";
            } else if (type === "danger") {
                notification.style.background = "linear-gradient(135deg, var(--danger-color), #c0392b)";
            }
            
            notification.classList.add("show");
            
            // 3秒后自动隐藏
            setTimeout(() => {
                notification.classList.remove("show");
            }, 3000);
        }

        /**
         * 向游戏日志添加一条记录
         * @param {string} message - 日志消息
         * @param {string} type - 消息类型，可选值: "normal", "danger", "success", "warning"
         */
        function log(message, type = "normal") {
            const logDiv = document.getElementById("log");
            const entry = document.createElement("div");
            entry.className = "log-entry";
            
            // 添加时间戳
            const timeSpan = document.createElement("span");
            timeSpan.className = "log-time";
            timeSpan.textContent = `[${new Date().toLocaleTimeString()}] `;
            
            // 添加消息内容
            const messageSpan = document.createElement("span");
            messageSpan.className = "log-message";
            
            // 根据类型设置颜色
            if (type === "danger") {
                messageSpan.classList.add("danger");
            } else if (type === "success") {
                messageSpan.classList.add("success");
            } else if (type === "warning") {
                messageSpan.classList.add("warning");
            } else if (type === "info") {
                messageSpan.classList.add("info");
            }
            
            // 高亮显示数字和重要信息
            message = message.replace(/(\d+)/g, '<span class="highlight">$1</span>');
            messageSpan.innerHTML = message;
            
            entry.appendChild(timeSpan);
            entry.appendChild(messageSpan);
            logDiv.appendChild(entry);
            
            // 自动滚动到底部
            logDiv.scrollTop = logDiv.scrollHeight;
            
            // 如果日志条目太多，删除最早的
            if (logDiv.children.length > 50) {
                logDiv.removeChild(logDiv.firstChild);
            }
        }

        /**
         * 获取当前成长阶段名称
         * @returns {string} 成长阶段名称
         */
        function getRealmName() {
            return gameData.realmNames[gameData.realm - 1];
        }

        /**
         * 更新技能展示区域
         */
        function updateSkillsDisplay() {
            const skillsList = document.getElementById("skillsList");
            const skillsCount = document.getElementById("skillsCount");
            skillsList.innerHTML = "";
            
            if (gameData.bugs.length === 0) {
                const noSkills = document.createElement("div");
                noSkills.textContent = "尚未学习任何技能";
                noSkills.style.color = "rgba(255,255,255,0.5)";
                noSkills.style.fontStyle = "italic";
                skillsList.appendChild(noSkills);
                skillsCount.textContent = "0";
                return;
            }
            
            skillsCount.textContent = gameData.bugs.length;
            
            gameData.bugs.forEach(skillName => {
                const skill = gameData.bugLibrary.find(b => b.name === skillName);
                const skillBadge = document.createElement("div");
                skillBadge.className = "skill-badge";
                
                if (skill) {
                    skillBadge.innerHTML = `<i class="${skill.icon}"></i> ${skill.name}`;
                } else {
                    skillBadge.textContent = skillName;
                }
                
                skillsList.appendChild(skillBadge);
            });
        }

        /**
         * 更新物品展示区域
         */
        function updateItemsDisplay() {
            const itemsList = document.getElementById("itemsList");
            const itemsCount = document.getElementById("itemsCount");
            itemsList.innerHTML = "";
            
            if (gameData.items.length === 0) {
                const noItems = document.createElement("div");
                noItems.textContent = "尚未获得任何物品";
                noItems.style.color = "rgba(255,255,255,0.5)";
                noItems.style.fontStyle = "italic";
                itemsList.appendChild(noItems);
                itemsCount.textContent = "0";
                return;
            }
            
            itemsCount.textContent = gameData.items.length;
            
            gameData.items.forEach(itemName => {
                const item = gameData.itemLibrary.find(i => i.name === itemName);
                const itemBadge = document.createElement("div");
                itemBadge.className = "item-badge";
                
                if (item) {
                    itemBadge.innerHTML = `<i class="${item.icon}"></i> ${item.name}`;
                } else {
                    itemBadge.textContent = itemName;
                }
                
                itemsList.appendChild(itemBadge);
            });
        }

        // =============================================================================
        // 角色编辑功能
        // =============================================================================
        
        /**
         * 打开角色编辑模态框
         */
        function openEditModal() {
            const modal = document.getElementById("editModal");
            modal.style.display = "flex";
            
            // 填充当前数据
            document.getElementById("newName").value = gameData.characterName;
            document.getElementById("newHeight").value = gameData.characterHeight;
            document.getElementById("newWeight").value = gameData.characterWeight;
            
            // 设置当前选中的头像
            const avatarOptions = document.querySelectorAll(".avatar-option");
            avatarOptions.forEach(option => {
                option.classList.remove("selected");
                if (option.getAttribute("data-icon") === gameData.characterAvatar) {
                    option.classList.add("selected");
                }
            });
            
            // 添加头像选择事件
            avatarOptions.forEach(option => {
                option.onclick = function() {
                    avatarOptions.forEach(opt => opt.classList.remove("selected"));
                    this.classList.add("selected");
                    
                    // 隐藏上传预览
                    document.getElementById("uploadPreview").style.display = "none";
                    gameData.characterAvatarType = "icon";
                };
            });
            
            // 设置上传图片预览
            const uploadPreview = document.getElementById("uploadPreview");
            const previewImage = document.getElementById("previewImage");
            
            if (gameData.characterAvatarType === "image" && gameData.characterAvatarData) {
                previewImage.src = gameData.characterAvatarData;
                uploadPreview.style.display = "block";
            } else {
                uploadPreview.style.display = "none";
            }
            
            // 设置立绘预览
            const illustrationPreview = document.getElementById("illustrationPreview");
            const previewIllustration = document.getElementById("previewIllustration");
            
            if (gameData.characterIllustrationType === "image" && gameData.characterIllustration) {
                previewIllustration.src = gameData.characterIllustration;
                illustrationPreview.style.display = "block";
            } else {
                illustrationPreview.style.display = "none";
            }
            
            // 添加头像文件上传事件
            document.getElementById("avatarUpload").addEventListener("change", function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewImage.src = e.target.result;
                        uploadPreview.style.display = "block";
                        
                        // 取消选择所有图标头像
                        avatarOptions.forEach(opt => opt.classList.remove("selected"));
                        gameData.characterAvatarType = "image";
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // 添加立绘文件上传事件
            document.getElementById("illustrationUpload").addEventListener("change", function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewIllustration.src = e.target.result;
                        illustrationPreview.style.display = "block";
                        gameData.characterIllustrationType = "image";
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        /**
         * 关闭角色编辑模态框
         */
        function closeEditModal() {
            const modal = document.getElementById("editModal");
            modal.style.display = "none";
        }

        /**
         * 保存角色信息
         */
        function saveCharacterInfo() {
            const newName = document.getElementById("newName").value.trim();
            const newHeight = parseInt(document.getElementById("newHeight").value);
            const newWeight = parseInt(document.getElementById("newWeight").value);
            
            // 获取选中的头像
            let newAvatar = null;
            let avatarType = "icon";
            
            const selectedIcon = document.querySelector(".avatar-option.selected");
            if (selectedIcon) {
                newAvatar = selectedIcon.getAttribute("data-icon");
            }
            
            // 检查是否有上传的头像图片
            const uploadPreview = document.getElementById("uploadPreview");
            const previewImage = document.getElementById("previewImage");
            
            if (uploadPreview.style.display === "block" && previewImage.src) {
                newAvatar = previewImage.src;
                avatarType = "image";
            }
            
            // 检查是否有上传的立绘图片
            const illustrationPreview = document.getElementById("illustrationPreview");
            const previewIllustration = document.getElementById("previewIllustration");
            let newIllustration = null;
            let illustrationType = "default";
            
            if (illustrationPreview.style.display === "block" && previewIllustration.src) {
                newIllustration = previewIllustration.src;
                illustrationType = "image";
            }
            
            // 验证输入
            if (!newName) {
                alert("请输入角色姓名！");
                return;
            }
            
            if (isNaN(newHeight) || newHeight < 50 || newHeight > 200) {
                alert("请输入有效的身高（50-200cm）！");
                return;
            }
            
            if (isNaN(newWeight) || newWeight < 10 || newWeight > 100) {
                alert("请输入有效的体重（10-100kg）！");
                return;
            }
            
            // 更新游戏数据
            const oldName = gameData.characterName;
            gameData.characterName = newName;
            gameData.characterAvatar = newAvatar;
            gameData.characterAvatarType = avatarType;
            gameData.characterAvatarData = avatarType === "image" ? newAvatar : null;
            gameData.characterIllustration = newIllustration;
            gameData.characterIllustrationType = illustrationType;
            gameData.characterHeight = newHeight;
            gameData.characterWeight = newWeight;
            
            // 更新UI
            updateUI();
            
            // 记录日志
            if (oldName !== newName) {
                log(`角色姓名从 <span class="highlight">${oldName}</span> 更改为 <span class="highlight">${newName}</span>！`, "success");
            }
            log(`更新了角色信息：身高 <span class="highlight">${newHeight}cm</span>，体重 <span class="highlight">${newWeight}kg</span>`, "info");
            
            // 显示通知
            showNotification("角色信息已更新！");
            
            // 关闭模态框
            closeEditModal();
        }

        /**
         * 打开设置模态框
         */
        function openSettingsModal() {
            const modal = document.getElementById("settingsModal");
            modal.style.display = "flex";
            
            // 设置当前选中的兴趣班
            const schoolButtons = document.querySelectorAll('#settingsModal [data-school]');
            schoolButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-school') === gameData.school) {
                    btn.classList.add('active');
                }
            });
            
            // 设置当前选中的朋友圈
            const factionButtons = document.querySelectorAll('#settingsModal [data-faction]');
            factionButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-faction') === gameData.faction) {
                    btn.classList.add('active');
                }
            });
        }

        /**
         * 关闭设置模态框
         */
        function closeSettingsModal() {
            const modal = document.getElementById("settingsModal");
            modal.style.display = "none";
        }

        // =============================================================================
        // 游戏核心功能 - 小男孩成长主题
        // =============================================================================
        
        /**
         * 探索功能 - 根据当前活动区域触发随机事件
         */
        function explore() {
            const region = gameData.regions.find(r => r.name === gameData.region);
            const event = Math.random();
            
            if (event < 0.3) { 
                // 30%概率遇到挑战
                const damage = Math.floor(Math.random() * 20) + 10;
                gameData.health = Math.max(0, gameData.health - damage);
                log(`在<span class="highlight">${gameData.region}</span>遇到<span class="highlight">${region.bugs[0]}</span>挑战！消耗 <span class="danger">${damage}</span> 点体力。`, "danger");
                
                if (gameData.health <= 0) {
                    handleExhaustion("在探索中体力耗尽");
                }
            } else if (event < 0.6) { 
                // 30%概率获得新技能
                const item = region.bugs[Math.floor(Math.random() * region.bugs.length)];
                gameData.bugs.push(item);
                log(`在<span class="highlight">${gameData.region}</span>学会新技能：<span class="success">${item}</span>！`, "success");
                showNotification(`学会了新技能：${item}！`);
            } else if (event < 0.8) { 
                // 20%概率获得物品
                const randomItem = gameData.itemLibrary[Math.floor(Math.random() * gameData.itemLibrary.length)];
                gameData.items.push(randomItem.name);
                log(`在<span class="highlight">${gameData.region}</span>发现物品：<span class="success">${randomItem.name}</span>！`, "success");
                showNotification(`发现了物品：${randomItem.name}！`);
            } else { 
                // 20%概率获得成就或特殊事件
                const achievements = ["小探险家", "好奇宝宝", "发现小能手"];
                const achievement = achievements[Math.floor(Math.random() * achievements.length)];
                
                if (!gameData.achievements.includes(achievement)) {
                    gameData.achievements.push(achievement);
                    log(`获得成就：<span class="success">${achievement}</span> <span class="achievement-badge">成就</span>！`, "success");
                    showNotification(`获得成就：${achievement}！`);
                } else {
                    // 如果没有新成就，则触发特殊事件
                    const specialEvents = [
                        { type: "money", amount: 10, message: "在路边捡到10元零花钱！" },
                        { type: "intelligence", amount: 5, message: "遇到一位老师，学到了新知识，智力+5！" },
                        { type: "social", amount: 5, message: "认识了一位新朋友，社交能力+5！" }
                    ];
                    
                    const event = specialEvents[Math.floor(Math.random() * specialEvents.length)];
                    
                    if (event.type === "money") {
                        gameData.money += event.amount;
                    } else if (event.type === "intelligence") {
                        gameData.intelligence += event.amount;
                    } else if (event.type === "social") {
                        gameData.social += event.amount;
                    }
                    
                    log(event.message, "success");
                    showNotification(event.message);
                }
            }
            updateUI();
        }

        /**
         * 学习技能 - 消耗精力学习新技能，有失败风险
         */
        function refineBug() {
            if (gameData.bugs.length < 1) {
                log("没有可学习的技能！", "warning");
                return;
            }
            
            const school = gameData.schools.find(s => s.name === gameData.school);
            let successRate = 0.7; // 基础成功率70%
            
            // 兴趣班加成
            if (school && school.bugBonus.includes(gameData.bugs[0])) {
                successRate += 0.2;
            }
            
            // 智力影响成功率
            successRate += gameData.intelligence / 200;
            
            const success = Math.random() <= successRate;
            
            if (success) {
                const refinedBug = gameData.bugs.shift();
                const essenceGain = Math.floor(Math.random() * 10) + 5;
                gameData.essence = Math.min(gameData.maxEssence, gameData.essence + essenceGain);
                log(`学习<span class="highlight">${refinedBug}</span>成功！获得 <span class="success">${essenceGain}</span> 点精力。`, "success");
                showNotification(`学习成功！获得${essenceGain}精力`);
                
                // 学习成功增加智力
                gameData.intelligence += 2;
                
                if (refinedBug === "编程") {
                    gameData.bugs.push("编程高手");
                    log(`成为<span class="success">编程高手</span>，解锁特殊能力！`, "success");
                    showNotification("成为编程高手！解锁特殊能力");
                }
            } else {
                const damage = Math.floor(Math.random() * 15) + 5;
                gameData.health = Math.max(0, gameData.health - damage);
                log(`学习失败！消耗过多体力，损失 <span class="danger">${damage}</span> 点体力。`, "danger");
                
                if (gameData.health <= 0) {
                    handleExhaustion("在学习中体力耗尽");
                }
            }
            updateUI();
        }

        /**
         * 锻炼功能 - 消耗精力获得成长经验
         */
        function cultivate() {
            if (gameData.essence < 10) {
                log("精力不足，无法锻炼！", "warning");
                return;
            }
            
            gameData.essence -= 10;
            const school = gameData.schools.find(s => s.name === gameData.school);
            const region = gameData.regions.find(r => r.name === gameData.region);
            
            let expGain = Math.floor(Math.random() * 20) + 10;
            
            // 兴趣班影响
            if (school && school.name === "美术班") {
                expGain = Math.ceil(expGain * 0.9); // 锻炼效果-10%
            }
            
            // 活动区域影响
            if (region && region.name === "学校") {
                gameData.health = Math.max(0, gameData.health - 1);
            }
            
            // 力量影响锻炼效果
            expGain += Math.floor(gameData.strength / 10);
            
            gameData.cultivationExp += expGain;
            
            if (gameData.realm > 5) {
                gameData.lifeSpan -= 1;
                log(`锻炼成功，但快乐值减少<span class="warning">1</span>点。当前快乐值：<span class="highlight">${gameData.lifeSpan}</span>`, "warning");
            } else {
                log(`锻炼成功，获得 <span class="success">${expGain}</span> 点成长经验。`, "success");
            }
            
            // 锻炼增加力量
            gameData.strength += 1;
            
            // 检查是否达到成长条件
            if (gameData.cultivationExp >= gameData.cultivationTarget) {
                log(`成长经验已足够，可以尝试<span class="highlight">成长</span>到下一阶段！`, "success");
                showNotification("成长经验已足够，可以尝试成长！");
            }
            
            updateUI();
        }

        /**
         * 游戏功能 - 与其他小朋友游戏
         */
        function fight() {
            if (gameData.health <= 0) {
                alert("你已体力耗尽，需要休息！");
                return;
            }
            
            const enemy = {
                name: "小伙伴",
                health: 50 + (gameData.region === "公园" ? 30 : 0),
                damage: 10,
                defense: 5
            };
            
            let playerHealth = gameData.health;
            let enemyHealth = enemy.health;
            
            let battleLog = [];
            
            // 模拟游戏过程（简化版）
            while (playerHealth > 0 && enemyHealth > 0) {
                // 玩家回合
                const playerDamage = Math.max(1, 10 + Math.floor(Math.random() * 10) - enemy.defense);
                enemyHealth -= playerDamage;
                battleLog.push(`你和<span class="highlight">${enemy.name}</span>玩游戏，获得 <span class="success">${playerDamage}</span> 点乐趣。`);
                
                if (enemyHealth <= 0) break;
                
                // 小伙伴回合
                const enemyDamage = Math.max(1, enemy.damage - (gameData.school === "体育班" ? 3 : 0));
                playerHealth -= enemyDamage;
                battleLog.push(`<span class="highlight">${enemy.name}</span>表现出色，你消耗 <span class="danger">${enemyDamage}</span> 点体力。`);
            }
            
            // 游戏结果
            if (playerHealth > 0) {
                gameData.health = playerHealth;
                const expGain = 20;
                const essenceGain = 10;
                
                gameData.cultivationExp += expGain;
                gameData.essence = Math.min(gameData.maxEssence, gameData.essence + essenceGain);
                
                // 随机获得技能
                const randomBug = gameData.bugLibrary[Math.floor(Math.random() * gameData.bugLibrary.length)];
                gameData.bugs.push(randomBug.name);
                
                log(`<span class="success">游戏胜利！</span>`, "success");
                battleLog.forEach(msg => log(msg));
                log(`获得经验：<span class="success">+${expGain}</span>，精力：<span class="success">+${essenceGain}</span>，技能：<span class="success">${randomBug.name}</span>`);
                
                // 游戏胜利增加社交能力
                gameData.social += 2;
                
                showNotification("游戏胜利！获得新技能");
            } else {
                gameData.health = 0;
                gameData.lifeSpan -= 5;
                log(`<span class="danger">游戏失败！</span>`, "danger");
                battleLog.forEach(msg => log(msg));
                log(`体力消耗过多，<span class="warning">快乐值-5</span>！`, "warning");
                
                if (gameData.lifeSpan <= 0) {
                    handleExhaustion("在游戏中体力耗尽");
                }
            }
            
            updateUI();
        }

        /**
         * 使用物品功能 - 消耗物品获得增益效果
         */
        function useItem() {
            if (gameData.items.length === 0) {
                log("没有可使用的物品！", "warning");
                return;
            }
            
            // 创建物品选择列表
            let itemList = "<div style='margin-bottom: 15px;'>请选择要使用的物品：</div>";
            gameData.items.forEach(item => {
                const itemData = gameData.itemLibrary.find(i => i.name === item);
                if (itemData) {
                    itemList += `<div style='padding: 5px; border-bottom: 1px solid rgba(255,255,255,0.1);'>
                        <button onclick="useSelectedItem('${item}')" style="background: var(--primary-color); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin-right: 10px;">使用</button>
                        <i class="${itemData.icon}"></i> ${item} - ${itemData.effect}
                    </div>`;
                }
            });
            
            // 显示物品选择对话框
            const itemDialog = document.createElement('div');
            itemDialog.innerHTML = `
                <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 3000; display: flex; justify-content: center; align-items: center;">
                    <div style="background: var(--container-bg); padding: 20px; border-radius: 10px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="margin: 0;">使用物品</h3>
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">&times;</button>
                        </div>
                        ${itemList}
                    </div>
                </div>
            `;
            document.body.appendChild(itemDialog);
        }

        /**
         * 使用选中的物品
         */
        function useSelectedItem(itemName) {
            const itemIndex = gameData.items.findIndex(item => item === itemName);
            if (itemIndex === -1) {
                log("无效物品！", "warning");
                return;
            }
            
            const itemData = gameData.itemLibrary.find(i => i.name === itemName);
            if (!itemData) {
                log("物品数据错误！", "warning");
                return;
            }
            
            // 使用物品
            gameData.items.splice(itemIndex, 1);
            
            switch(itemName) {
                case "零食":
                    gameData.health = Math.min(gameData.maxHealth, gameData.health + 30);
                    log(`吃<span class="highlight">零食</span>，体力恢复<span class="success">30</span>点！`, "success");
                    showNotification("吃零食！体力+30");
                    break;
                case "饮料":
                    gameData.health = Math.min(gameData.maxHealth, gameData.health + 50);
                    log(`喝<span class="highlight">饮料</span>，体力恢复<span class="success">50</span>点！`, "success");
                    showNotification("喝饮料！体力+50");
                    break;
                case "玩具":
                    gameData.lifeSpan += 5;
                    log(`玩<span class="highlight">玩具</span>，快乐值增加<span class="success">5</span>点！`, "success");
                    showNotification("玩玩具！快乐值+5");
                    break;
                case "书籍":
                    gameData.intelligence += 10;
                    log(`阅读<span class="highlight">书籍</span>，智力增加<span class="success">10</span>点！`, "success");
                    showNotification("阅读书籍！智力+10");
                    break;
                case "运动鞋":
                    gameData.strength += 5;
                    log(`穿上<span class="highlight">运动鞋</span>，力量增加<span class="success">5</span>点！`, "success");
                    showNotification("穿上运动鞋！力量+5");
                    break;
                case "手机":
                    gameData.social += 10;
                    log(`使用<span class="highlight">手机</span>，社交能力增加<span class="success">10</span>点！`, "success");
                    showNotification("使用手机！社交能力+10");
                    break;
                default:
                    log("物品效果未定义！", "warning");
                    return;
            }
            
            // 移除对话框
            const dialog = document.querySelector('div[style*="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7);"]');
            if (dialog) dialog.remove();
            
            updateUI();
        }

        /**
         * 成长阶段 - 尝试成长到下一阶段，有失败风险
         */
        function breakthrough() {
            if (gameData.cultivationExp < gameData.cultivationTarget) {
                log("成长经验不足，无法成长！", "warning");
                return;
            }
            
            const risk = gameData.realm > 5;
            let success = true;
            
            if (risk) {
                success = Math.random() > 0.3; // 70%成功率
            }
            
            if (success) {
                gameData.realm++;
                gameData.cultivationExp = 0;
                gameData.cultivationTarget = 100 + (gameData.realm - 1) * 50;
                
                // 成长带来的属性增长
                gameData.maxHealth += 20;
                gameData.health = gameData.maxHealth;
                gameData.maxEssence += 25;
                gameData.essence = Math.min(gameData.maxEssence, gameData.essence + 30);
                gameData.characterAge += 1;
                
                // 成长带来身高和体重的自然增长
                gameData.characterHeight += Math.floor(Math.random() * 5) + 3;
                gameData.characterWeight += Math.floor(Math.random() * 2) + 1;
                
                if (gameData.realm > 5) {
                    gameData.lifeSpan -= 10;
                    log(`成长至<span class="highlight">${getRealmName()}</span>！快乐值减少<span class="warning">10</span>点，当前：<span class="highlight">${gameData.lifeSpan}</span>。`, "warning");
                }
                
                if (gameData.realm === 9) {
                    gameData.bugs.push("人生经验");
                    log(`<span class="success">成为成熟人士！</span>获得<span class="highlight">人生经验</span>，生活更加丰富多彩！`, "success");
                    showNotification("成为成熟人士！游戏胜利！");
                } else {
                    log(`<span class="success">成功成长</span>至：<span class="highlight">${getRealmName()}</span>！`, "success");
                    showNotification(`成长成功！当前阶段：${getRealmName()}`);
                }
            } else {
                gameData.realm--;
                gameData.cultivationExp = 0;
                gameData.health = Math.max(1, gameData.health - 50);
                gameData.lifeSpan -= 20;
                log(`<span class="danger">成长失败！</span>遇到挫折，体力大减，快乐值降低！阶段回落至：<span class="highlight">${getRealmName()}</span>，快乐值：<span class="highlight">${gameData.lifeSpan}</span>。`, "danger");
            }
            
            updateUI();
        }

        /**
         * 换兴趣班 - 更改当前兴趣班
         */
        function changeSchool(newSchool) {
            if (gameData.schools.find(s => s.name === newSchool) || newSchool === "无") {
                gameData.school = newSchool;
                log(`更换兴趣班成功！当前兴趣班：<span class="highlight">${newSchool}</span>`, "success");
                showNotification(`更换兴趣班成功！当前兴趣班：${newSchool}`);
                
                // 更新按钮状态
                const schoolButtons = document.querySelectorAll('#settingsModal [data-school]');
                schoolButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-school') === newSchool) {
                        btn.classList.add('active');
                    }
                });
            } else {
                log(`无效兴趣班！`, "warning");
            }
            
            updateUI();
        }

        /**
         * 换朋友圈 - 更改当前朋友圈
         */
        function changeFaction(newFaction) {
            if (gameData.factions.find(f => f.name === newFaction) || newFaction === "独自玩耍") {
                gameData.faction = newFaction;
                log(`更换朋友圈成功！当前朋友圈：<span class="highlight">${newFaction}</span>`, "success");
                showNotification(`更换朋友圈成功！当前朋友圈：${newFaction}`);
                
                // 更新按钮状态
                const factionButtons = document.querySelectorAll('#settingsModal [data-faction]');
                factionButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-faction') === newFaction) {
                        btn.classList.add('active');
                    }
                });
            } else {
                log(`无效朋友圈！`, "warning");
            }
            
            updateUI();
        }

        /**
         * 换活动区 - 更改当前活动区域
         */
        function changeRegion(newRegion) {
            if (gameData.regions.find(r => r.name === newRegion)) {
                gameData.region = newRegion;
                log(`更换活动区域成功！当前活动区域：<span class="highlight">${newRegion}</span>`, "success");
                showNotification(`更换活动区域成功！当前活动区域：${newRegion}`);
                
                // 更新按钮状态
                const regionButtons = document.querySelectorAll('.region-btn');
                regionButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-region') === newRegion) {
                        btn.classList.add('active');
                    }
                });
            } else {
                log(`无效活动区域！`, "warning");
            }
            
            updateUI();
        }

        /**
         * 处理体力耗尽 - 重置游戏状态
         * @param {string} cause - 耗尽原因描述
         */
        function handleExhaustion(cause) {
            log(`<span class="danger">你已体力耗尽！</span>原因：${cause}`, "danger");
            alert(`游戏结束！\n原因：${cause}\n最终成长阶段：${getRealmName()}`);
            
            // 重置游戏
            gameData = {
                characterName: "小明",
                characterAge: 6,
                characterAvatar: "fas fa-child",
                characterAvatarType: "icon",
                characterAvatarData: null,
                characterHeight: 115,
                characterWeight: 20,
                characterIllustration: null,
                characterIllustrationType: "default",
                gameVersion: "1.2.0",
                lastUpdate: "2023-10-15",
                realm: 1,
                health: 100,
                maxHealth: 100,
                essence: 50,
                maxEssence: 100,
                bugs: [],
                items: [],
                primaryBug: null,
                cultivationExp: 0,
                cultivationTarget: 100,
                lifeSpan: 50,
                intelligence: 30,
                strength: 25,
                social: 20,
                money: 50,
                school: "无",
                faction: "独自玩耍",
                region: "家里",
                realmNames: gameData.realmNames,
                bugLibrary: gameData.bugLibrary,
                itemLibrary: gameData.itemLibrary,
                schools: gameData.schools,
                factions: gameData.factions,
                regions: gameData.regions,
                achievements: []
            };
            
            updateUI();
            log(`<span class="success">游戏已重置，开始新的成长之旅！</span>`, "success");
        }

        // =============================================================================
        // UI更新功能
        // =============================================================================
        
        /**
         * 更新游戏界面
         */
        function updateUI() {
            // 更新角色卡片
            document.getElementById("characterName").textContent = gameData.characterName;
            document.getElementById("characterAge").textContent = `年龄: ${gameData.characterAge}岁`;
            document.getElementById("characterHealth").textContent = `${gameData.health}/${gameData.maxHealth}`;
            document.getElementById("characterEnergy").textContent = `${gameData.essence}/${gameData.maxEssence}`;
            document.getElementById("characterHappiness").textContent = gameData.lifeSpan;
            document.getElementById("characterIntelligence").textContent = gameData.intelligence;
            document.getElementById("characterStrength").textContent = gameData.strength;
            document.getElementById("characterSocial").textContent = gameData.social;
            document.getElementById("characterHeight").textContent = `${gameData.characterHeight}cm`;
            document.getElementById("characterWeight").textContent = `${gameData.characterWeight}kg`;
            document.getElementById("characterMoney").textContent = gameData.money;
            
            // 更新头像
            const avatars = document.querySelectorAll(".player-avatar, .character-avatar");
            avatars.forEach(avatar => {
                // 清空内容
                avatar.innerHTML = '';
                
                if (gameData.characterAvatarType === "image" && gameData.characterAvatarData) {
                    // 使用图片头像
                    const img = document.createElement('img');
                    img.src = gameData.characterAvatarData;
                    img.alt = "角色头像";
                    avatar.appendChild(img);
                } else {
                    // 使用图标头像
                    const icon = document.createElement('i');
                    icon.className = gameData.characterAvatar;
                    avatar.appendChild(icon);
                }
            });
            
            // 更新基本属性
            document.getElementById("realm").textContent = getRealmName();
            document.getElementById("school").textContent = gameData.school;
            document.getElementById("faction").textContent = gameData.faction;
            document.getElementById("region").textContent = gameData.region;
            
            // 更新成长进度条
            const progress = Math.min(100, (gameData.cultivationExp / gameData.cultivationTarget) * 100);
            document.getElementById("cultivationProgress").style.width = progress + "%";
            document.getElementById("cultivationPercent").textContent = Math.round(progress) + "%";
            
            // 更新技能和物品展示
            updateSkillsDisplay();
            updateItemsDisplay();
            
            // 更新版本信息
            document.getElementById("versionInfo").textContent = 
                `版本号: ${gameData.gameVersion} | 最后更新: ${gameData.lastUpdate}`;
            
            // 更新按钮状态
            document.querySelectorAll(".action-btn").forEach(btn => {
                if (btn.textContent === "成长" && gameData.cultivationExp < gameData.cultivationTarget) {
                    btn.disabled = true;
                } else {
                    btn.disabled = false;
                }
            });
            
            // 更新立绘
            updateIllustration();
        }

        /**
         * 更新角色立绘
         */
        function updateIllustration() {
            const illustrationContainer = document.getElementById("characterIllustration");
            illustrationContainer.innerHTML = '';
            
            if (gameData.characterIllustrationType === "image" && gameData.characterIllustration) {
                // 使用上传的立绘图片
                const img = document.createElement('img');
                img.src = gameData.characterIllustration;
                img.alt = "角色立绘";
                img.style.maxWidth = "100%";
                img.style.maxHeight = "100%";
                img.style.objectFit = "contain";
                illustrationContainer.appendChild(img);
            } else {
                // 使用默认立绘
                const defaultIllustration = document.createElement('div');
                defaultIllustration.id = "defaultIllustration";
                defaultIllustration.style.display = "flex";
                defaultIllustration.style.flexDirection = "column";
                defaultIllustration.style.alignItems = "center";
                defaultIllustration.style.justifyContent = "center";
                defaultIllustration.style.color = "white";
                defaultIllustration.style.height = "100%";
                
                const icon = document.createElement('i');
                icon.className = "fas fa-child";
                icon.style.fontSize = "4rem";
                icon.style.marginBottom = "10px";
                
                const text = document.createElement('p');
                text.textContent = "上传立绘图片";
                
                defaultIllustration.appendChild(icon);
                defaultIllustration.appendChild(text);
                illustrationContainer.appendChild(defaultIllustration);
            }
        }

        // =============================================================================
        // 游戏初始化
        // =============================================================================
        
        /**
         * 初始化游戏
         */
        function initGame() {
            updateUI();
            log("<span class='success'>欢迎来到小男孩成长世界！开始你的成长之旅吧！</span>", "success");
            log("<span class='info'>提示：你可以通过探索、学习、锻炼和游戏来提升自己的能力！</span>", "info");
            log("<span class='info'>提示：点击头像或姓名旁边的编辑图标可以修改角色信息！</span>", "info");
            log("<span class='info'>提示：现在可以上传自定义图片作为头像和立绘了！</span>", "info");
            log("<span class='info'>提示：点击'更多设置'可以更换兴趣班和朋友圈！</span>", "info");
        }

        // 启动游戏
        initGame();
    </script>
</body>
</html>
